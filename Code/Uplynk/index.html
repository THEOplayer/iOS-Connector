<h1 id="theoplayer-uplynk">THEOPlayer ü§ù Uplynk</h1>
<p>THEOplayer-Connector-Uplynk for iOS provides an integration between
the THEOplayerSDK and the Uplynk CMS. It allows the
<code>THEOplayerSDK</code> to playback uplynk sources.</p>
<p>For example xcode projects with this connector see <a
href="../Uplynk-Examples/README.md">Uplynk-Examples</a>.</p>
<h2 id="installation">Installation</h2>
<h3 id="swift-package-manager"><a
href="https://swift.org/package-manager/">Swift Package Manager</a></h3>
<ol type="1">
<li><p>In Xcode, install the THEOPlayer iOS-Connector package by
navigating to <strong>File &gt; Add Packages</strong></p></li>
<li><p>In the prompt that appears, select the iOS-Connector GitHub
repository:
<code>https://github.com/THEOplayer/iOS-Connector</code></p></li>
<li><p>Select the version you want to use. &gt; the Uplynk connector is
available for versions &gt;= 8.12 only.</p></li>
<li><p>Choose the Connector libraries you want to include in your
app.</p></li>
</ol>
<p>To support custom feature builds of THEOplayerSDK perform the
following steps:</p>
<ol type="1">
<li>Clone this repository to your computer.</li>
<li>Use a <a
href="https://developer.apple.com/documentation/xcode/editing-a-package-dependency-as-a-local-package">local
override</a> of the <code>theoplayer-sdk-ios</code> package by selecting
the folder <code>../../Helpers/TheoSPM/theoplayer-sdk-ios</code> in
Finder and dragging it into the Project navigator of your Xcode
project.</li>
<li>Place your custom THEOplayerSDK.xcframework at
<code>../../Helpers/TheoSPM/theoplayer-sdk-ios/THEOplayerSDK.xcframework</code>.
(It is also possible to place your xcframework somewhere else. In that
case make sure to update the <a
href="../../Helpers/TheoSPM/theoplayer-sdk-ios/Package.swift">Package.swift</a>
manifest inside the your local override so that it points to your custom
THEOplayer build)</li>
<li>If Xcode complains about a missing xcframework
<ol type="1">
<li>Choose <code>File</code> &gt; <code>Packages</code> &gt;
<code>Reset Package Caches</code> from the menu bar.</li>
<li>If it is still not working, make sure to remove any
<code>THEOplayerSDK.xcframework</code> inclusions that you manually
installed before installing this THEOplayer-Connector-Uplynk
package.</li>
</ol></li>
</ol>
<h3 id="cocoapods"><a
href="https://guides.cocoapods.org/using/getting-started.html#getting-started">Cocoapods</a></h3>
<ol type="1">
<li>Create a Podfile if you don‚Äôt already have one. From the root of
your project directory, run the following command:
<code>pod init</code></li>
<li>To your Podfile, add the Uplynk connector pods that you want to use
in your app: <code>pod 'THEOplayer-Connector-Uplynk'</code></li>
<li>Install the pods using <code>pod install</code> , then open your
<code>.xcworkspace</code> file to see the project in Xcode.</li>
</ol>
<p>To support custom feature builds of THEOplayerSDK perform the
following steps:</p>
<ol type="1">
<li>Clone this repository to your computer.</li>
<li>Use a <a
href="https://guides.cocoapods.org/using/the-podfile.html#using-the-files-from-a-folder-local-to-the-machine">local
override</a> of the <code>THEOplayerSDK-basic</code> pod by adding the
following line to your projects Podfile:
<code>pod 'THEOplayerSDK-basic', :path =&gt; 'iOS-Connector/Helpers/TheoPod'</code>
and make sure the path points to the <a
href="../../Helpers/TheoPod">TheoPod folder</a>.</li>
</ol>
<h2 id="usage">Usage</h2>
<p>Import the <code>THEOplayerConnectorUplynk</code> module</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">THEOplayerConnectorUplynk</span></span></code></pre></div>
<p>Create an <code>UplynkConfiguration</code> that contains information
on how to handle ad skipping and seeking over ads scenarios:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="va">uplynkConfiguration</span> <span class="op">=</span> UplynkConfiguration<span class="op">(</span>defaultSkipOffset<span class="op">:</span> <span class="op">...,</span> skippedAdStrategy<span class="op">:</span> <span class="op">...)</span></span></code></pre></div>
<blockquote>
<p><code>defaultSkipOffset</code> describes how many seconds the user
has to wait before an ad is skippable. <code>skippedAdStrategy</code>
controls how the connector behaves when seeking over ads. There are
three values: <code>playAll</code>, <code>playLast</code> and
<code>playNone</code>. The first option forces playback of all the
unwatched ads before the seek point. <code>playLast</code> forces
playback of the last ad before the seek point.</p>
</blockquote>
<p>After that, create the <code>UplynkConnector</code> using a
<code>THEOPlayer</code> instance and the above configuration:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="va">connector</span> <span class="op">=</span> UplynkConnector<span class="op">(</span>player<span class="op">:</span> yourTHEOplayer<span class="op">,</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                                configuration<span class="op">:</span> uplynkConfiguration</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                eventListener<span class="op">:</span> <span class="kw">nil</span><span class="op">)</span></span></code></pre></div>
<p>If you would like to receive the Uplynk API responses, then you need
to implement the <code>UplynkEventListener</code> protocol, and pass
your event listener in the <code>eventListener</code> argument
above.</p>
<p>Next, when creating a <code>TypedSource</code>, you can pass a
<code>UplynkSSAIConfiguration</code> to describe the server side ad
injection configuration for Uplynk, such as the asset IDs to play,
whether the content to be played is DRM protected or not, etc:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="va">ssaiConfiguration</span> <span class="op">=</span> UplynkSSAIConfiguration<span class="op">(</span>assetIDs<span class="op">:[</span> your list of asset IDs<span class="op">],</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                                assetType<span class="op">:</span> <span class="op">.</span>asset or <span class="op">.</span>channel<span class="op">,</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                                prefix<span class="op">:</span> <span class="st">&quot;https://content.uplynk.com&quot;</span><span class="op">,</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                contentProtected<span class="op">:</span> <span class="kw">true</span> or <span class="kw">false</span><span class="op">)</span></span></code></pre></div>
<p>For more information about what each configuration option is, have a
look at the API reference for this class.</p>
<p>For each source, you can attach the uplynk configuration above to the
<code>ssai</code> property:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="va">myTypedSource</span> <span class="op">=</span> TypedSource<span class="op">(</span>src<span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">,</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                                type<span class="op">:</span> <span class="st">&quot;application/x-mpegurl&quot;</span><span class="op">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                                ssai<span class="op">:</span> ssaiConfiguration<span class="op">)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">let</span> <span class="va">mySource</span> <span class="op">=</span> SourceDescription<span class="op">(</span>source<span class="op">:</span> myTypedSource<span class="op">)</span></span></code></pre></div>
<p>Finally you can set the source on your <code>THEOplayer</code>
instance:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode swift"><code class="sourceCode swift"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>yourTHEOplayer<span class="op">.</span>source <span class="op">=</span> mySource</span></code></pre></div>
